import { getAuthenticationHeaders } from '../../../src/utils/auth';
import { testJwt } from '../../mocks/jwt';

describe('Auth utils', () => {
    describe('#getAuthenticationHeaders', () => {
        it('should return an error if no props provided', () => {
            expect(getAuthenticationHeaders).to.throw('Must provide authentication information.');
        });

        it('should transform a JWT', () => {
            const baseHeaders = {
                jwt: testJwt(),
            };

            const headers = getAuthenticationHeaders(baseHeaders);
            headers.should.eql({
                Authorization: 'Bearer ' + baseHeaders.jwt,
            });
        });

        it('should return an error if no JWT provided', () => {
            const baseHeaders = {
                what: 'is this?',
            };
            expect(() => getAuthenticationHeaders(baseHeaders)).to.throw();
        });
    });
});
